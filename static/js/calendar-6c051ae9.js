import{Z as H,a6 as R,y as P,r,o as z,b as M,c as I,d as t,u as d,U as k,F as N,e as Z,m as j}from"./index-a005ceea.js";let T=H();function q(p,o){return R({method:"get",url:`/user.do/getClockInRecord?year=${p}&month=${o+1}`,headers:{authorization:T.user.token}})}function A(p){function o(c){const g=new Date(c),m=g.getFullYear(),y=_(g.getMonth()+1),D=_(g.getDate());return`${m}-${y}-${D}`}function _(c){return c>9?c:"0"+c}return R({method:"post",url:"/user.do/clockIn",data:{date:o(p)},headers:{"Content-Type":"application/x-www-form-urlencoded",authorization:T.user.token}})}const O={class:"calendar_page"},Q=t("span",{class:"icon iconfont icon-fanhui"},null,-1),U=[Q],V=t("div",{class:"bcg"},null,-1),G={class:"calendar"},J={class:"calendar_header"},K={class:"year_picker"},W=t("pre",null,"<",-1),X=[W],ee=t("pre",null,">",-1),te=[ee],ae={class:"calendar_body"},se={class:"calendar_week_day"},le={class:"calendar_footer"},ne={class:"clock"},oe={class:"situation"},ce=t("div",{class:"dailySignature"},[t("div",{class:"box"},[t("div",{class:"title"},"今日日签"),t("div",{class:"record_box"},[t("div",null,"做不到别人眼中的强者也没有关系，做到最好的自己就好。")])])],-1),ie=P({beforeRouteLeave(p,o,_){let c=j();c.footerNavIsShow=!0,_()}}),de=Object.assign(ie,{__name:"calendar",setup(p){let o=[];async function _(s,e){let a=await q(s,e),n=a.data.msg.data.dateList;if(a.data.msg.data.searchSuccess)for(let l=0;l<n.length;l++)n[l].split("-")[2].charAt(0)=="0"?o[l]=n[l].split("-")[2].split("0")[1]:o[l]=n[l].split("-")[2]}let c=s=>s%4===0&&s%100!==0&&s%400!==0||s%100===0&&s%400===0,g=s=>c(s)?29:28,m,y,D;async function x(s){let e=await A(s);console.log(e),e.data.msg.data.isSuccess&&(Y.classList.add("clock_in"),F.value="今日已打卡",b.value="已签到")}let E=r(["周日","周一","周二","周三","周四","周五","周六"]);const w=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"];let L=new Date,v=r(L.getMonth()),$=r(w[v.value]),S=r(null),i=r(L.getFullYear()),C=r(null),F=r("今日还未打卡"),b=r("签到"),Y;return r(!1),z(()=>{async function s(e,a){let n=[31,g(e),31,30,31,30,31,31,30,31,30,31],u=new Date;e||(e=u.getFullYear()),$.value=`${w[a]}`,i.value=e,o=[],await _(i.value,v.value),S.value.innerHTML="";let l=new Date(e,a,1);for(let h=0;h<=n[a]+l.getDay()-1;h++){let f=document.createElement("div");if(h>=l.getDay()){for(let B of o)B==h-(l.getDay()-1)&&f.classList.add("clock_in");f.innerHTML=h-l.getDay()+1,h-l.getDay()+1===u.getDate()&&e===u.getFullYear()&&a===u.getMonth()&&(f.classList.add("curr_date"),f.classList.contains("clock_in")&&(F.value="今日已打卡",b.value="已签到"),Y=f)}S.value.appendChild(f)}}s(i.value,v.value),m=()=>{--i.value,s(i.value,v.value)},y=()=>{++i.value,s(i.value,v.value)},w.forEach((e,a)=>{let n=document.createElement("div");n.innerHTML=`<div data-month="${a}">${e}</div>`,n.querySelector("div").onclick=u=>{C.value.classList.remove("show"),$.value=w[a],v.value=a,s(i.value,a),u.stopPropagation()},C.value.appendChild(n)}),D=e=>{C.value.classList.add("show"),e.stopPropagation()}}),(s,e)=>(M(),I("div",O,[t("div",{class:"left",onClick:e[0]||(e[0]=a=>s.$router.push("/DueToday"))},U),V,t("div",G,[t("div",J,[t("span",{class:"month_picker",onClick:e[1]||(e[1]=a=>d(D)(a))},k(d($)),1),t("div",K,[t("span",{class:"year_change",onClick:e[2]||(e[2]=a=>d(m)())},X),t("span",null,k(d(i)),1),t("span",{class:"year_change",onClick:e[3]||(e[3]=a=>d(y)())},te)])]),t("div",ae,[t("div",se,[(M(!0),I(N,null,Z(d(E),a=>(M(),I("div",{key:a},k(a),1))),128))]),t("div",{class:"calendar_days",ref_key:"calendar_days",ref:S},null,512)]),t("div",{class:"month_list",ref_key:"month_list",ref:C},null,512),t("div",le,[t("div",ne,[t("div",oe,k(d(F)),1),t("button",{class:"situation",onClick:e[4]||(e[4]=a=>x(d(L)))},k(d(b)),1)]),ce])])]))}});export{de as default};
