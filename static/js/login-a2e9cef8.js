import{_ as j,r as p,m as G,a as C,o as J,b as w,c as k,d as s,F as T,e as L,u as l,w as c,v as m,f as z,g as K,p as Q,h as X,l as q,s as I}from"./index-075354d6.js";import{c as Y,a as ee,P as se,b as ae}from"./user-e4c24856.js";const g=b=>(Q("data-v-4a258a9d"),b=b(),X(),b),te={class:"login_page"},le={class:"bg"},oe={class:"square"},re={class:"circle"},ne=g(()=>s("header",null,null,-1)),ie={class:"mar_box"},ue={class:"container"},de=g(()=>s("div",{class:"logo"},null,-1)),pe={action:"./index.html"},ce={class:"form_control"},ve={class:"form_control"},fe={class:"form_control"},he={class:"form_control"},me={class:"captcha"},_e={class:"form_control"},ge=g(()=>s("p",null,"请正确填写信息",-1)),ye=[ge],we={class:"login_box"},ke=g(()=>s("div",{class:"logo"},null,-1)),be={action:"./index.html",class:"form"},Me={class:"form_control"},Te={class:"form_control"},Le=g(()=>s("p",null,"手机号或密码错误",-1)),qe=[Le],xe={class:"items"},Ue=g(()=>s("span",null,"下次自动登录",-1)),Se={__name:"login",setup(b){let y=p(null).value,x=p(null).value,o=p([]),i=p([]),v=p(null).value,M=p(null),U=p(null),$=G();const d=C({phone:"",password:"",auto:!1}),r=C({phone:"",username:"",password1:"",password2:"",auto:!1,checkMsg:0,code:""}),n=C({phone:!1,username:!1,password1:!1,password2:!1,code:!1});let f=t=>{o.value.push(t)},h=t=>{i.value.push(t)},H=()=>{x.style.top="142vw",y.style.top="-8vw",y.innerHTML="已有账号，去登录"},N=()=>{x.style.top="36vw",y.style.top="-25vw",y.innerHTML="没有账号，去注册"},V=/^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\d{8}$/,A=/^[a-zA-Z0-9_]{6,16}$/,Z=/^[0-9a-zA-Z\u4e00-\u9fa5]{1,6}$/,D=async t=>{if(V.test(d.phone)&&A.test(d.password)){let a=(await se(d.phone,d.password)).data.msg;if(a.data.isSuccess){let u={};u.token=a.data.token,u.phone=d.phone,d.auto?(q("auto",!0),q("user",u)):(q("auto",!1),I("user",u)),t.push("/DueToday"),$.footerNavIsShow=!0}else M.value.style.opacity=1}else M.value.style.opacity=1},E=async t=>{if(n.phone&&n.username&&n.password1&&n.password2&&n.code){let a=(await ae(r.phone,r.username,r.password1)).data.msg;if(a.data.isSuccess){let u={};u.token=a.data.userId,u.phone=r.phone,q("auto",!1),I("user",u),t.push("/DueToday"),$.footerNavIsShow=!0}else alert("注册失败，请重新注册")}else U.value.style.opacity=1};J(()=>{R();let t=[];for(let e=0;e<i.value.length;e++)t.push(o.value[e].innerHTML),i.value[e].onblur=()=>{e==0&&(V.test(r.phone)?F(r.phone,e):i.value[e].value!=""&&(o.value[e].innerHTML="手机号格式错误",o.value[e].style.color="red",n.phone=!1)),e==1&&(Z.test(r.username)?P(r.username,e):i.value[e].value!=""&&(o.value[e].innerHTML="昵称格式错误",o.value[e].style.color="red",n.username=!1)),e==2&&i.value[e].value!=""&&!A.test(i.value[e].value)?(o.value[e].innerHTML="密码为6到16位(字母,数字,下划线)",o.value[e].style.color="red",n.password1=!1):n.password1=!0,i.value[2].value!=i.value[3].value&&i.value[2].value!=""&&i.value[3].value!=""?(o.value[e].innerHTML="两次密码不一致",o.value[e].style.color="red",n.password2=!1):n.password2=!0,e==4&&i.value[4].value!=""&&r.code.toUpperCase()!=S.value.toUpperCase()?(o.value[e].innerHTML="验证码错误",o.value[e].style.color="red",n.code=!1):n.code=!0,i.value[e].value==""&&o.value[e].classList.remove("label_change")},i.value[e].onfocus=()=>{o.value[e].innerHTML=t[e],o.value[e].style.color="#000",o.value[e].classList.add("label_change"),M.value.style.opacity=0,U.value.style.opacity=0}});async function F(t,e){let a=await Y(t);a.data.msg.data.isOk?n.phone=!0:(o.value[e].innerHTML=a.data.msg.content,o.value[e].style.color="red",n.phone=!1)}async function P(t,e){let a=await ee(t);a.data.msg.data.isOk?n.username=!0:(o.value[e].innerHTML=a.data.msg.content,o.value[e].style.color="red",n.username=!1)}let S=p(""),B=t=>{R(),t.stopPropagation(),i.value[4].focus()};function O(){var t="abcdefghjkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789",e=t.split(""),a=Math.floor(Math.random()*57),u=e[a];return u}function W(t,e){e.beginPath(),e.moveTo(Math.floor(Math.random()*t.width),Math.floor(Math.random()*t.height)),e.lineTo(Math.floor(Math.random()*t.width),Math.floor(Math.random()*t.height)),e.lineWidth=1,e.strokeStyle="#000",e.stroke()}function R(){S.value="";var t=v.getContext("2d");t.clearRect(0,0,v.width,v.height),t.strokeStyle="#FFF",t.strokeRect(0,0,v.width,v.height);for(let _=0;_<30;_++)W(v,t);for(let _=0;_<5;_++){t.font="76px Arial",t.save();var e=1-Math.random()*2,a=e/8,u=O();t.rotate(a),t.fillText(u,20+45*_,100),t.restore(),S.value+=u}}return(t,e)=>(w(),k("div",te,[s("div",le,[s("div",oe,[s("ul",null,[(w(),k(T,null,L(5,a=>s("li")),64))])]),s("div",re,[s("ul",null,[(w(),k(T,null,L(5,a=>s("li")),64))])])]),ne,s("div",ie,[s("div",ue,[s("div",{class:"register",onClick:e[7]||(e[7]=(...a)=>l(H)&&l(H)(...a))},[de,s("form",pe,[s("div",ce,[c(s("input",{class:"register_data input",type:"text",name:"phone",required:"required",pattern:"^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\\d{8}$",title:"请输入正确的手机号",ref:l(h),"onUpdate:modelValue":e[0]||(e[0]=a=>r.phone=a)},null,512),[[m,r.phone]]),s("label",{ref:l(f)},"请输入手机号",512)]),s("div",ve,[c(s("input",{class:"register_data input",type:"text",name:"username",required:"required",pattern:"^[0-9a-zA-Z\\u4e00-\\u9fa5]{1,6}$",title:"请输入正确的昵称,不包括特殊字符",ref:l(h),"onUpdate:modelValue":e[1]||(e[1]=a=>r.username=a)},null,512),[[m,r.username]]),s("label",{ref:l(f)},"请输入昵称",512)]),s("div",fe,[c(s("input",{class:"register_data input",type:"password",name:"password1",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$",title:"密码为6到16位（字母，数字，下划线）",ref:l(h),"onUpdate:modelValue":e[2]||(e[2]=a=>r.password1=a)},null,512),[[m,r.password1]]),s("label",{ref:l(f)},"请输入密码",512)]),s("div",he,[c(s("input",{class:"input",type:"password",name:"password2",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$",title:"密码为6到16位（字母，数字，下划线）",ref:l(h),"onUpdate:modelValue":e[3]||(e[3]=a=>r.password2=a)},null,512),[[m,r.password2]]),s("label",{ref:l(f)},"请确认密码",512)]),s("div",me,[s("div",_e,[c(s("input",{class:"input",type:"text",name:"captcha",required:"required",ref:l(h),"onUpdate:modelValue":e[4]||(e[4]=a=>r.code=a)},null,512),[[m,r.code]]),s("label",{ref:l(f)},"请输入验证码",512)]),s("canvas",{class:"search_canvas",ref_key:"canvas",ref:v,onClick:e[5]||(e[5]=a=>l(B)(a))},null,512)]),s("div",{class:"err",ref_key:"registerErr",ref:U},ye,512),s("button",{type:"button",onClick:e[6]||(e[6]=a=>l(E)(t.$router))},[(w(),k(T,null,L(4,a=>s("span")),64)),z(" 注册 ")])])]),s("div",{class:"login",ref_key:"loginbox",ref:x,onClick:e[12]||(e[12]=(...a)=>l(N)&&l(N)(...a))},[s("div",{class:"change",ref_key:"change",ref:y},"没有账号，去注册",512),s("div",we,[ke,s("form",be,[s("div",Me,[c(s("input",{class:"login_data input",type:"text",name:"identification",required:"required",pattern:"^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\\d{8}$",title:"请输入正确的手机号","onUpdate:modelValue":e[8]||(e[8]=a=>d.phone=a),ref:l(h)},null,512),[[m,d.phone]]),s("label",{ref:l(f)},"请输入手机号",512)]),s("div",Te,[c(s("input",{class:"login_data input",type:"password",name:"password",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$","onUpdate:modelValue":e[9]||(e[9]=a=>d.password=a),ref:l(h)},null,512),[[m,d.password]]),s("label",{ref:l(f)},"请输入密码",512)]),s("div",{class:"err",ref_key:"loginErr",ref:M},qe,512),s("button",{type:"button",onClick:e[10]||(e[10]=a=>l(D)(t.$router))},[(w(),k(T,null,L(4,a=>s("span")),64)),z(" 登录 ")]),s("div",xe,[c(s("input",{type:"checkbox",class:"auto","onUpdate:modelValue":e[11]||(e[11]=a=>d.auto=a)},null,512),[[K,d.auto]]),Ue])])])],512)])])]))}},He=j(Se,[["__scopeId","data-v-4a258a9d"]]);export{He as default};
