import{_ as j,r as p,m as G,a as C,o as J,b as w,c as k,d as a,F as T,e as L,u as l,w as c,v as m,f as z,g as K,p as Q,h as X,l as q,s as I}from"./index-a005ceea.js";import{c as Y,a as ee,P as ae,b as se}from"./user-f8df4f6b.js";const g=b=>(Q("data-v-f09878f6"),b=b(),X(),b),te={class:"login_page"},le={class:"bg"},oe={class:"square"},re={class:"circle"},ne=g(()=>a("header",null,null,-1)),ue={class:"mar_box"},ie={class:"container"},de=g(()=>a("div",{class:"logo"},null,-1)),pe={action:"./index.html"},ce={class:"form_control"},ve={class:"form_control"},fe={class:"form_control"},he={class:"form_control"},me={class:"captcha"},_e={class:"form_control"},ge=g(()=>a("p",null,"请正确填写信息",-1)),ye=[ge],we={class:"login_box"},ke=g(()=>a("div",{class:"logo"},null,-1)),be={action:"./index.html",class:"form"},Me={class:"form_control"},Te={class:"form_control"},Le=g(()=>a("p",null,"手机号或密码错误",-1)),qe=[Le],xe={class:"items"},Ue=g(()=>a("span",null,"下次自动登录",-1)),Se={__name:"login",setup(b){let y=p(null),x=p(null),o=p([]),u=p([]),v=p(null),M=p(null),U=p(null),$=G();const d=C({phone:"",password:"",auto:!1}),r=C({phone:"",username:"",password1:"",password2:"",auto:!1,checkMsg:0,code:""}),n=C({phone:!1,username:!1,password1:!1,password2:!1,code:!1});let f=t=>{o.value.push(t)},h=t=>{u.value.push(t)},H=()=>{x.value.style.top="142vw",y.value.style.top="-8vw",y.value.innerHTML="已有账号，去登录"},N=()=>{x.value.style.top="36vw",y.value.style.top="-25vw",y.value.innerHTML="没有账号，去注册"},V=/^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\d{8}$/,A=/^[a-zA-Z0-9_]{6,16}$/,Z=/^[0-9a-zA-Z\u4e00-\u9fa5]{1,6}$/,D=async t=>{if(V.test(d.phone)&&A.test(d.password)){let s=(await ae(d.phone,d.password)).data.msg;if(s.data.isSuccess){let i={};i.token=s.data.token,i.phone=d.phone,d.auto?(q("auto",!0),q("user",i)):(q("auto",!1),I("user",i)),t.push("/DueToday"),$.footerNavIsShow=!0}else M.value.style.opacity=1}else M.value.style.opacity=1},E=async t=>{if(n.phone&&n.username&&n.password1&&n.password2&&n.code){let s=(await se(r.phone,r.username,r.password1)).data.msg;if(s.data.isSuccess){let i={};i.token=s.data.userId,i.phone=r.phone,q("auto",!1),I("user",i),t.push("/DueToday"),$.footerNavIsShow=!0}else alert("注册失败，请重新注册")}else U.value.style.opacity=1};J(()=>{R();let t=[];for(let e=0;e<u.value.length;e++)t.push(o.value[e].innerHTML),u.value[e].onblur=()=>{e==0&&(V.test(r.phone)?F(r.phone,e):u.value[e].value!=""&&(o.value[e].innerHTML="手机号格式错误",o.value[e].style.color="red",n.phone=!1)),e==1&&(Z.test(r.username)?P(r.username,e):u.value[e].value!=""&&(o.value[e].innerHTML="昵称格式错误",o.value[e].style.color="red",n.username=!1)),e==2&&u.value[e].value!=""&&!A.test(u.value[e].value)?(o.value[e].innerHTML="密码为6到16位(字母,数字,下划线)",o.value[e].style.color="red",n.password1=!1):n.password1=!0,u.value[2].value!=u.value[3].value&&u.value[2].value!=""&&u.value[3].value!=""?(o.value[e].innerHTML="两次密码不一致",o.value[e].style.color="red",n.password2=!1):n.password2=!0,e==4&&u.value[4].value!=""&&r.code.toUpperCase()!=S.value.toUpperCase()?(o.value[e].innerHTML="验证码错误",o.value[e].style.color="red",n.code=!1):n.code=!0,u.value[e].value==""&&o.value[e].classList.remove("label_change")},u.value[e].onfocus=()=>{o.value[e].innerHTML=t[e],o.value[e].style.color="#000",o.value[e].classList.add("label_change"),M.value.style.opacity=0,U.value.style.opacity=0}});async function F(t,e){let s=await Y(t);s.data.msg.data.isOk?n.phone=!0:(o.value[e].innerHTML=s.data.msg.content,o.value[e].style.color="red",n.phone=!1)}async function P(t,e){let s=await ee(t);s.data.msg.data.isOk?n.username=!0:(o.value[e].innerHTML=s.data.msg.content,o.value[e].style.color="red",n.username=!1)}let S=p(""),B=t=>{R(),t.stopPropagation(),u.value[4].focus()};function O(){var t="abcdefghjkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789",e=t.split(""),s=Math.floor(Math.random()*57),i=e[s];return i}function W(t,e){e.beginPath(),e.moveTo(Math.floor(Math.random()*t.value.width),Math.floor(Math.random()*t.value.height)),e.lineTo(Math.floor(Math.random()*t.value.width),Math.floor(Math.random()*t.value.height)),e.lineWidth=1,e.strokeStyle="#000",e.stroke()}function R(){S.value="";var t=v.value.getContext("2d");t.clearRect(0,0,v.value.width,v.value.height),t.strokeStyle="#FFF",t.strokeRect(0,0,v.value.width,v.value.height);for(let _=0;_<30;_++)W(v,t);for(let _=0;_<5;_++){t.font="76px Arial",t.save();var e=1-Math.random()*2,s=e/8,i=O();t.rotate(s),t.fillText(i,20+45*_,100),t.restore(),S.value+=i}}return(t,e)=>(w(),k("div",te,[a("div",le,[a("div",oe,[a("ul",null,[(w(),k(T,null,L(5,s=>a("li")),64))])]),a("div",re,[a("ul",null,[(w(),k(T,null,L(5,s=>a("li")),64))])])]),ne,a("div",ue,[a("div",ie,[a("div",{class:"register",onClick:e[7]||(e[7]=(...s)=>l(H)&&l(H)(...s))},[de,a("form",pe,[a("div",ce,[c(a("input",{class:"register_data input",type:"text",name:"phone",required:"required",pattern:"^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\\d{8}$",title:"请输入正确的手机号",ref:l(h),"onUpdate:modelValue":e[0]||(e[0]=s=>r.phone=s)},null,512),[[m,r.phone]]),a("label",{ref:l(f)},"请输入手机号",512)]),a("div",ve,[c(a("input",{class:"register_data input",type:"text",name:"username",required:"required",pattern:"^[0-9a-zA-Z\\u4e00-\\u9fa5]{1,6}$",title:"请输入正确的昵称,不包括特殊字符",ref:l(h),"onUpdate:modelValue":e[1]||(e[1]=s=>r.username=s)},null,512),[[m,r.username]]),a("label",{ref:l(f)},"请输入昵称",512)]),a("div",fe,[c(a("input",{class:"register_data input",type:"password",name:"password1",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$",title:"密码为6到16位（字母，数字，下划线）",ref:l(h),"onUpdate:modelValue":e[2]||(e[2]=s=>r.password1=s)},null,512),[[m,r.password1]]),a("label",{ref:l(f)},"请输入密码",512)]),a("div",he,[c(a("input",{class:"input",type:"password",name:"password2",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$",title:"密码为6到16位（字母，数字，下划线）",ref:l(h),"onUpdate:modelValue":e[3]||(e[3]=s=>r.password2=s)},null,512),[[m,r.password2]]),a("label",{ref:l(f)},"请确认密码",512)]),a("div",me,[a("div",_e,[c(a("input",{class:"input",type:"text",name:"captcha",required:"required",ref:l(h),"onUpdate:modelValue":e[4]||(e[4]=s=>r.code=s)},null,512),[[m,r.code]]),a("label",{ref:l(f)},"请输入验证码",512)]),a("canvas",{class:"search_canvas",ref_key:"canvas",ref:v,onClick:e[5]||(e[5]=s=>l(B)(s))},null,512)]),a("div",{class:"err",ref_key:"registerErr",ref:U},ye,512),a("button",{type:"button",onClick:e[6]||(e[6]=s=>l(E)(t.$router))},[(w(),k(T,null,L(4,s=>a("span")),64)),z(" 注册 ")])])]),a("div",{class:"login",ref_key:"loginbox",ref:x,onClick:e[12]||(e[12]=(...s)=>l(N)&&l(N)(...s))},[a("div",{class:"change",ref_key:"change",ref:y},"没有账号，去注册",512),a("div",we,[ke,a("form",be,[a("div",Me,[c(a("input",{class:"login_data input",type:"text",name:"identification",required:"required",pattern:"^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\\d{8}$",title:"请输入正确的手机号","onUpdate:modelValue":e[8]||(e[8]=s=>d.phone=s),ref:l(h)},null,512),[[m,d.phone]]),a("label",{ref:l(f)},"请输入手机号",512)]),a("div",Te,[c(a("input",{class:"login_data input",type:"password",name:"password",required:"required",pattern:"^[a-zA-Z0-9_]{6,16}$","onUpdate:modelValue":e[9]||(e[9]=s=>d.password=s),ref:l(h)},null,512),[[m,d.password]]),a("label",{ref:l(f)},"请输入密码",512)]),a("div",{class:"err",ref_key:"loginErr",ref:M},qe,512),a("button",{type:"button",onClick:e[10]||(e[10]=s=>l(D)(t.$router))},[(w(),k(T,null,L(4,s=>a("span")),64)),z(" 登录 ")]),a("div",xe,[c(a("input",{type:"checkbox",class:"auto","onUpdate:modelValue":e[11]||(e[11]=s=>d.auto=s)},null,512),[[K,d.auto]]),Ue])])])],512)])])]))}},He=j(Se,[["__scopeId","data-v-f09878f6"]]);export{He as default};
